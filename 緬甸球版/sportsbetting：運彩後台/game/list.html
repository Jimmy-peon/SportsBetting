<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>後台管理系統</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- 添加日期選擇器樣式 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
</head>
<body class="bg-gray-50">
    <div class="p-4">
        <!-- 搜尋與過濾區域 -->
        <div class="bg-white rounded-lg shadow-sm mb-6 p-4">
            <div class="flex flex-col justify-between items-start gap-4">
                <div class="w-full">
                    <!-- 搜尋條件 -->
                    <div class="flex flex-col sm:flex-row mb-3 items-start sm:items-center gap-3">
                        <div class="flex items-center flex-wrap sm:flex-nowrap">
                            <span class="mr-2 text-sm font-medium text-gray-700">賽事編號</span>
                            <input id="match-id" type="text" placeholder="請輸入賽事編號..." class="w-full sm:w-64 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 py-2 px-3 text-sm">
                        </div>
                        
                        <div class="flex items-center flex-wrap sm:flex-nowrap">
                            <span class="mr-2 text-sm font-medium text-gray-700">所屬聯賽</span>
                            <select id="league-select" class="w-full sm:w-48 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 py-2 px-3 text-sm">
                                <option value="">全部</option>
                                <option value="英超聯賽">英超聯賽</option>
                                <option value="西甲聯賽">西甲聯賽</option>
                                <option value="德甲聯賽">德甲聯賽</option>
                            </select>
                        </div>
                        
                        <div class="flex items-center flex-wrap sm:flex-nowrap">
                            <span class="mr-2 text-sm font-medium text-gray-700">賽事狀態</span>
                            <select id="status-select" class="w-full sm:w-48 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 py-2 px-3 text-sm">
                                <option value="">全部</option>
                                <option value="開放投注">開放投注</option>
                                <option value="暫停投注">暫停投注</option>
                                <option value="已結算">已結算</option>
                                <option value="已取消">已取消</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- 時間篩選 -->
                    <div class="flex flex-col sm:flex-row mb-3 items-start sm:items-center gap-3">
                        <div class="flex items-center flex-wrap sm:flex-nowrap flex-grow">
                            <select id="date-type-select" class="mr-2 w-32 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 py-2 px-3 text-sm">
                                <option value="create-time">創建時間</option>
                                <option value="start-time">賽事開始時間</option>
                                <option value="settle-time">結算時間</option>
                            </select>
                            <div class="flex flex-grow gap-1">
                                <input type="text" id="start-date" placeholder="起始日期" class="datepicker border border-gray-300 rounded-md px-3 py-2 text-sm flex-grow" readonly>
                                <span class="self-center">-</span>
                                <input type="text" id="end-date" placeholder="結束日期" class="datepicker border border-gray-300 rounded-md px-3 py-2 text-sm flex-grow" readonly>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 查詢與重置按鈕 -->
                    <div class="flex gap-2">
                        <button id="search-btn" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none flex items-center">
                            <i class="fas fa-search mr-2"></i>
                            查詢
                        </button>
                        <button id="reset-btn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 focus:outline-none flex items-center">
                            <i class="fas fa-redo-alt mr-2"></i>
                            重置
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 新增賽事按鈕區域 -->
        <div class="flex justify-end mb-4">
            <a href="add.html" id="add-match-btn" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none flex items-center">
                <i class="fas fa-plus mr-2"></i>
                新增賽事
            </a>
        </div>
        
        <!-- 賽事列表表格 -->
        <div class="bg-white rounded-lg shadow-sm overflow-hidden">
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <!-- 基本賽事信息 -->
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                賽事編號
                            </th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                所屬聯賽
                            </th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                主隊名稱
                            </th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                客隊名稱
                            </th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                賽事開始時間
                            </th>
                            
                            <!-- 賠率信息 (將在表格行分成上下兩行顯示) -->
                            <th scope="col" colspan="13" class="px-3 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
                                賠率信息
                            </th>
                            
                            <!-- 狀態和統計 -->
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                賽事狀態
                            </th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                總投注筆數
                            </th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                總投注金額
                            </th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                創建時間
                            </th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                操作
                            </th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <!-- 賽事1 - 上行：讓球相關信息 -->
                        <tr class="hover:bg-gray-50 border-b-0">
                            <!-- 基本信息 - 跨行顯示 -->
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">EPL20230620</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm font-medium text-gray-900">英超聯賽</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">曼聯</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">利物浦</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">2023-06-20</div>
                                <div class="text-sm text-gray-600">20:00</div>
                            </td>
                            
                            <!-- 讓球信息 (上行) -->
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">讓球隊伍</div>
                                <div class="text-sm font-medium text-gray-900">曼聯</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0 text-center">
                                <div class="text-xs text-gray-600">讓球數</div>
                                <div class="text-sm font-medium text-gray-900">-1</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0 text-center">
                                <div class="text-xs text-gray-600">盤口讓球賠率</div>
                                <div class="text-sm font-medium text-gray-900">+95</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">賽前主隊賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.85</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">賽前客隊賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.85</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">賽中主隊賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.80</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">賽中客隊賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.80</div>
                            </td>
                            
                            <!-- 空白列，讓大小球信息與讓球信息對齊 -->
                            <td class="px-2 py-1 whitespace-nowrap border-b-0" colspan="6"></td>
                            
                            <!-- 狀態和統計 - 跨行顯示 -->
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
                                    開放投注
                                </span>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">142</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">258,600</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">2023-06-18</div>
                                <div class="text-sm text-gray-600">10:55:20</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap text-sm font-medium align-top" rowspan="2">
                                <div class="relative inline-block text-left">
                                    <button type="button" class="operation-menu-btn inline-flex justify-center items-center w-full px-2 py-1 border border-gray-300 shadow-sm text-sm font-medium rounded-md bg-white text-gray-700 hover:bg-gray-50 focus:outline-none">
                                        操作
                                        <svg class="-mr-1 ml-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                                        </svg>
                                    </button>
                                    <div class="operation-menu hidden origin-top-right absolute right-0 mt-2 w-36 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 divide-y divide-gray-100 focus:outline-none z-10" role="menu" aria-orientation="vertical" tabindex="-1">
                                        <div class="py-1" role="none">
                                            <a href="edit.html?id=EPL20230620" class="group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 w-full text-left" role="menuitem" tabindex="-1">
                                                <i class="fas fa-edit mr-3 text-indigo-600"></i>編輯賽事
                                            </a>
                                            <button class="js-pause-bet group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 w-full text-left" role="menuitem" tabindex="-1" data-match-id="EPL20230620">
                                                <i class="fas fa-pause mr-3 text-yellow-600"></i>暫停投注
                                            </button>
                                            <button class="js-settle-match group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 w-full text-left" role="menuitem" tabindex="-1" data-match-id="EPL20230620" data-home-team="曼聯" data-away-team="利物浦">
                                                <i class="fas fa-check-double mr-3 text-blue-600"></i>結算賽事
                                            </button>
                                            <button class="js-cancel-match group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 w-full text-left" role="menuitem" tabindex="-1" data-match-id="EPL20230620">
                                                <i class="fas fa-times-circle mr-3 text-red-600"></i>取消賽事
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- 賽事1 - 下行：大小球相關信息 -->
                        <tr class="hover:bg-gray-50 border-t-0">
                            <!-- 大小球信息 (下行) -->
                            <td class="px-2 py-1 whitespace-nowrap border-t-0"></td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0 text-center">
                                <div class="text-xs text-gray-600">總進球數</div>
                                <div class="text-sm font-medium text-gray-900">3</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0 text-center">
                                <div class="text-xs text-gray-600">盤口大小球賠率</div>
                                <div class="text-sm font-medium text-gray-900">-95</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0">
                                <div class="text-xs text-gray-600">賽前大球賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.85</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0">
                                <div class="text-xs text-gray-600">賽前小球賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.85</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0">
                                <div class="text-xs text-gray-600">賽中大球賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.80</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0">
                                <div class="text-xs text-gray-600">賽中小球賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.80</div>
                            </td>
                            
                            <!-- 空白列，與上行對齊 -->
                            <td class="px-2 py-1 whitespace-nowrap border-t-0" colspan="6"></td>
                        </tr>

                        <!-- 賽事2 - 上行：讓球相關信息 -->
                        <tr class="hover:bg-gray-50 border-b-0">
                            <!-- 基本信息 - 跨行顯示 -->
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">LAL20230618</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm font-medium text-gray-900">西甲聯賽</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">巴塞隆納</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">皇家馬德里</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">2023-06-18</div>
                                <div class="text-sm text-gray-600">22:30</div>
                            </td>
                            
                            <!-- 讓球信息 (上行) -->
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">讓球隊伍</div>
                                <div class="text-sm font-medium text-gray-900">皇家馬德里</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0 text-center">
                                <div class="text-xs text-gray-600">讓球數</div>
                                <div class="text-sm font-medium text-gray-900">0</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0 text-center">
                                <div class="text-xs text-gray-600">盤口讓球賠率</div>
                                <div class="text-sm font-medium text-gray-900">+90</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">賽前主隊賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.85</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">賽前客隊賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.85</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">賽中主隊賠率</div>
                                <div class="text-sm font-medium text-green-600">0.80</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">賽中客隊賠率</div>
                                <div class="text-sm font-medium text-green-600">0.80</div>
                            </td>
                            
                            <!-- 空白列，讓大小球信息與讓球信息對齊 -->
                            <td class="px-2 py-1 whitespace-nowrap border-b-0" colspan="6"></td>
                            
                            <!-- 狀態和統計 - 跨行顯示 -->
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                    暫停投注
                                </span>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">98</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">175,320</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">2023-06-18</div>
                                <div class="text-sm text-gray-600">18:40:15</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap text-sm font-medium align-top" rowspan="2">
                                <div class="relative inline-block text-left">
                                    <button type="button" class="operation-menu-btn inline-flex justify-center items-center w-full px-2 py-1 border border-gray-300 shadow-sm text-sm font-medium rounded-md bg-white text-gray-700 hover:bg-gray-50 focus:outline-none">
                                        操作
                                        <svg class="-mr-1 ml-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                                        </svg>
                                    </button>
                                    <div class="operation-menu hidden origin-top-right absolute right-0 mt-2 w-36 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 divide-y divide-gray-100 focus:outline-none z-10" role="menu" aria-orientation="vertical" tabindex="-1">
                                        <div class="py-1" role="none">
                                            <a href="edit.html?id=LAL20230618" class="group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 w-full text-left" role="menuitem" tabindex="-1">
                                                <i class="fas fa-edit mr-3 text-indigo-600"></i>編輯賽事
                                            </a>
                                            <button class="js-pause-bet group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 w-full text-left" role="menuitem" tabindex="-1" data-match-id="LAL20230618">
                                                <i class="fas fa-pause mr-3 text-yellow-600"></i>暫停投注
                                            </button>
                                            <button class="js-settle-match group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 w-full text-left" role="menuitem" tabindex="-1" data-match-id="LAL20230618" data-home-team="巴塞隆納" data-away-team="皇家馬德里">
                                                <i class="fas fa-check-double mr-3 text-blue-600"></i>結算賽事
                                            </button>
                                            <button class="js-cancel-match group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 w-full text-left" role="menuitem" tabindex="-1" data-match-id="LAL20230618">
                                                <i class="fas fa-times-circle mr-3 text-red-600"></i>取消賽事
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- 賽事2 - 下行：大小球相關信息 -->
                        <tr class="hover:bg-gray-50 border-t-0">
                            <!-- 大小球信息 (下行) -->
                            <td class="px-2 py-1 whitespace-nowrap border-t-0"></td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0 text-center">
                                <div class="text-xs text-gray-600">總進球數</div>
                                <div class="text-sm font-medium text-gray-900">3</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0 text-center">
                                <div class="text-xs text-gray-600">盤口大小球賠率</div>
                                <div class="text-sm font-medium text-gray-900">-90</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0">
                                <div class="text-xs text-gray-600">賽前大球賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.85</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0">
                                <div class="text-xs text-gray-600">賽前小球賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.85</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0">
                                <div class="text-xs text-gray-600">賽中大球賠率</div>
                                <div class="text-sm font-medium text-green-600">0.80</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0">
                                <div class="text-xs text-gray-600">賽中小球賠率</div>
                                <div class="text-sm font-medium text-green-600">0.80</div>
                            </td>
                            
                            <!-- 空白列，與上行對齊 -->
                            <td class="px-2 py-1 whitespace-nowrap border-t-0" colspan="6"></td>
                        </tr>

                        <!-- 賽事3 - 上行：讓球相關信息 -->
                        <tr class="hover:bg-gray-50 border-b-0">
                            <!-- 基本信息 - 跨行顯示 -->
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">BUN20230615</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm font-medium text-gray-900">德甲聯賽</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">拜仁慕尼黑</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">多特蒙德</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">2023-06-15</div>
                                <div class="text-sm text-gray-600">19:30</div>
                            </td>
                            
                            <!-- 讓球信息 (上行) -->
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">讓球隊伍</div>
                                <div class="text-sm font-medium text-gray-900">多特蒙德</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0 text-center">
                                <div class="text-xs text-gray-600">讓球數</div>
                                <div class="text-sm font-medium text-gray-900">1</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0 text-center">
                                <div class="text-xs text-gray-600">盤口讓球賠率</div>
                                <div class="text-sm font-medium text-gray-900">-100</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">賽前主隊賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.85</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">賽前客隊賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.85</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">賽中主隊賠率</div>
                                <div class="text-sm font-medium text-gray-500">-</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">賽中客隊賠率</div>
                                <div class="text-sm font-medium text-gray-500">-</div>
                            </td>
                            
                            <!-- 空白列，讓大小球信息與讓球信息對齊 -->
                            <td class="px-2 py-1 whitespace-nowrap border-b-0" colspan="6"></td>
                            
                            <!-- 狀態和統計 - 跨行顯示 -->
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">
                                    已結算
                                </span>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">187</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">320,450</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">2023-06-15</div>
                                <div class="text-sm text-gray-600">21:45:10</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap text-sm font-medium align-top" rowspan="2">
                                <div class="relative inline-block text-left">
                                    <button type="button" class="operation-menu-btn inline-flex justify-center items-center w-full px-2 py-1 border border-gray-300 shadow-sm text-sm font-medium rounded-md bg-white text-gray-700 hover:bg-gray-50 focus:outline-none">
                                        操作
                                        <svg class="-mr-1 ml-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                                        </svg>
                                    </button>
                                    <div class="operation-menu hidden origin-top-right absolute right-0 mt-2 w-36 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 divide-y divide-gray-100 focus:outline-none z-10" role="menu" aria-orientation="vertical" tabindex="-1">
                                        <div class="py-1" role="none">
                                            <a href="detail.html?id=BUN20230615" class="group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 w-full text-left" role="menuitem" tabindex="-1">
                                                <i class="fas fa-eye mr-3 text-gray-600"></i>查看詳情
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- 賽事3 - 下行：大小球相關信息 -->
                        <tr class="hover:bg-gray-50 border-t-0">
                            <!-- 大小球信息 (下行) -->
                            <td class="px-2 py-1 whitespace-nowrap border-t-0"></td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0 text-center">
                                <div class="text-xs text-gray-600">總進球數</div>
                                <div class="text-sm font-medium text-gray-900">4</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0 text-center">
                                <div class="text-xs text-gray-600">盤口大小球賠率</div>
                                <div class="text-sm font-medium text-gray-900">+90</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0">
                                <div class="text-xs text-gray-600">賽前大球賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.85</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0">
                                <div class="text-xs text-gray-600">賽前小球賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.85</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0">
                                <div class="text-xs text-gray-600">賽中大球賠率</div>
                                <div class="text-sm font-medium text-gray-500">-</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0">
                                <div class="text-xs text-gray-600">賽中小球賠率</div>
                                <div class="text-sm font-medium text-gray-500">-</div>
                            </td>
                            
                            <!-- 空白列，與上行對齊 -->
                            <td class="px-2 py-1 whitespace-nowrap border-t-0" colspan="6"></td>
                        </tr>

                        <!-- 賽事4 - 上行：讓球相關信息 -->
                        <tr class="hover:bg-gray-50 border-b-0">
                            <!-- 基本信息 - 跨行顯示 -->
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">SER20240320</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm font-medium text-gray-900">意甲聯賽</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">國際米蘭</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">AC米蘭</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">2024-03-20</div>
                                <div class="text-sm text-gray-600">21:00</div>
                            </td>
                            
                            <!-- 讓球信息 (上行) -->
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">讓球隊伍</div>
                                <div class="text-sm font-medium text-gray-900">國際米蘭</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0 text-center">
                                <div class="text-xs text-gray-600">讓球數</div>
                                <div class="text-sm font-medium text-gray-900">1</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0 text-center">
                                <div class="text-xs text-gray-600">盤口讓球賠率</div>
                                <div class="text-sm font-medium text-gray-900">-95</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">賽前主隊賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.85</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">賽前客隊賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.85</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">賽中主隊賠率</div>
                                <div class="text-sm font-medium text-gray-500">-</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-b-0">
                                <div class="text-xs text-gray-600">賽中客隊賠率</div>
                                <div class="text-sm font-medium text-gray-500">-</div>
                            </td>
                            
                            <!-- 空白列，讓大小球信息與讓球信息對齊 -->
                            <td class="px-2 py-1 whitespace-nowrap border-b-0" colspan="6"></td>
                            
                            <!-- 狀態和統計 - 跨行顯示 -->
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                    取消
                                </span>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">56</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">89,600</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap align-top" rowspan="2">
                                <div class="text-sm text-gray-900">2024-03-20</div>
                                <div class="text-sm text-gray-600">15:30:20</div>
                            </td>
                            <td class="px-3 py-2 whitespace-nowrap text-sm font-medium align-top" rowspan="2">
                                <div class="relative inline-block text-left">
                                    <button type="button" class="operation-menu-btn inline-flex justify-center items-center w-full px-2 py-1 border border-gray-300 shadow-sm text-sm font-medium rounded-md bg-white text-gray-700 hover:bg-gray-50 focus:outline-none">
                                        操作
                                        <svg class="-mr-1 ml-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                                        </svg>
                                    </button>
                                    <div class="operation-menu hidden origin-top-right absolute right-0 mt-2 w-36 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 divide-y divide-gray-100 focus:outline-none z-10" role="menu" aria-orientation="vertical" tabindex="-1">
                                        <div class="py-1" role="none">
                                            <a href="detail.html?id=SER20240320" class="group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 w-full text-left" role="menuitem" tabindex="-1">
                                                <i class="fas fa-eye mr-3 text-gray-600"></i>查看詳情
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- 賽事4 - 下行：大小球相關信息 -->
                        <tr class="hover:bg-gray-50 border-t-0">
                            <!-- 大小球信息 (下行) -->
                            <td class="px-2 py-1 whitespace-nowrap border-t-0"></td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0 text-center">
                                <div class="text-xs text-gray-600">總進球數</div>
                                <div class="text-sm font-medium text-gray-900">3</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0 text-center">
                                <div class="text-xs text-gray-600">盤口大小球賠率</div>
                                <div class="text-sm font-medium text-gray-900">-90</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0">
                                <div class="text-xs text-gray-600">賽前大球賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.85</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0">
                                <div class="text-xs text-gray-600">賽前小球賠率</div>
                                <div class="text-sm font-medium text-gray-900">0.85</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0">
                                <div class="text-xs text-gray-600">賽中大球賠率</div>
                                <div class="text-sm font-medium text-gray-500">-</div>
                            </td>
                            <td class="px-2 py-1 whitespace-nowrap border-t-0">
                                <div class="text-xs text-gray-600">賽中小球賠率</div>
                                <div class="text-sm font-medium text-gray-500">-</div>
                            </td>
                            
                            <!-- 空白列，與上行對齊 -->
                            <td class="px-2 py-1 whitespace-nowrap border-t-0" colspan="6"></td>
                        </tr>

                    </tbody>
                </table>
            </div>

            <!-- 分頁控制 -->
            <div class="bg-white px-6 py-4 border-t border-gray-200 flex items-center justify-between">
                <div class="flex-1 flex justify-between sm:hidden">
                    <a href="#" class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                        上一頁
                    </a>
                    <a href="#" class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                        下一頁
                    </a>
                </div>
                <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between">
                    <div>
                        <p class="text-sm text-gray-700">
                            顯示第 <span class="font-medium">1</span> 到 <span class="font-medium">4</span> 筆，共 <span class="font-medium">24</span> 筆結果
                        </p>
                    </div>
                    <div>
                        <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px" aria-label="Pagination">
                            <a href="#" class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50">
                                <span class="sr-only">上一頁</span>
                                <i class="fas fa-chevron-left text-xs"></i>
                            </a>
                            <a href="#" aria-current="page" class="z-10 bg-indigo-50 border-indigo-500 text-indigo-600 relative inline-flex items-center px-4 py-2 border text-sm font-medium">
                                1
                            </a>
                            <a href="#" class="bg-white border-gray-300 text-gray-500 hover:bg-gray-50 relative inline-flex items-center px-4 py-2 border text-sm font-medium">
                                2
                            </a>
                            <a href="#" class="bg-white border-gray-300 text-gray-500 hover:bg-gray-50 hidden md:inline-flex relative items-center px-4 py-2 border text-sm font-medium">
                                3
                            </a>
                            <span class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700">
                                ...
                            </span>
                            <a href="#" class="bg-white border-gray-300 text-gray-500 hover:bg-gray-50 hidden md:inline-flex relative items-center px-4 py-2 border text-sm font-medium">
                                5
                            </a>
                            <a href="#" class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50">
                                <span class="sr-only">下一頁</span>
                                <i class="fas fa-chevron-right text-xs"></i>
                            </a>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 在頁面底部添加日期選擇器和下拉選單功能腳本 -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/zh-tw.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            try {
                console.log('頁面加載完成，初始化...');
                
            // 配置起始日期選擇器
            const startDatePicker = flatpickr("#start-date", {
                dateFormat: "Y-m-d",
                locale: "zh-tw",
                onChange: function(selectedDates, dateStr) {
                    // 當選擇起始日期後，自動聚焦到結束日期
                    if (selectedDates.length > 0) {
                        setTimeout(() => {
                            document.getElementById('end-date').focus();
                        }, 100);
                    }
                }
            });
            
            // 配置結束日期選擇器
            const endDatePicker = flatpickr("#end-date", {
                dateFormat: "Y-m-d",
                locale: "zh-tw"
            });
                
            // 搜尋按鈕事件
            document.getElementById('search-btn').addEventListener('click', function() {
                const matchId = document.getElementById('match-id').value.trim();
                const league = document.getElementById('league-select').value;
                const status = document.getElementById('status-select').value;
                const dateType = document.getElementById('date-type-select').value;
                const startDate = document.getElementById('start-date').value;
                const endDate = document.getElementById('end-date').value;
                
                // 實際應用中會發送請求到後端API
                console.log({ 
                    matchId, 
                    league, 
                    status,
                    dateType,
                    startDate,
                    endDate
                });
                
                // 模擬篩選表格 - 實際應用應該是重新加載數據
                alert('搜尋條件已提交，將顯示篩選結果');
            });
            
            // 重置按鈕事件
            document.getElementById('reset-btn').addEventListener('click', function() {
                document.getElementById('match-id').value = '';
                document.getElementById('league-select').value = '';
                document.getElementById('status-select').value = '';
                document.getElementById('date-type-select').value = 'create-time'; // 重置為創建時間
                startDatePicker.clear(); // 清除起始日期
                endDatePicker.clear();   // 清除結束日期
            });
            
            // 支持Enter鍵搜尋
            document.getElementById('match-id').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    document.getElementById('search-btn').click();
                }
            });
            
            // 首先關閉所有已打開的選單，確保初始狀態乾淨
            document.querySelectorAll('.operation-menu').forEach(menu => {
                menu.classList.add('hidden');
            });
            
            // 移除所有現有的點擊事件處理器，避免重複綁定
            document.querySelectorAll('.operation-menu-btn').forEach(btn => {
                const newBtn = btn.cloneNode(true);
                btn.parentNode.replaceChild(newBtn, btn);
            });
            
            // 重新綁定下拉選單功能 - 直接綁定到文檔上使用事件委託
            document.addEventListener('click', function(e) {
                // 如果點擊的是下拉選單按鈕
                if (e.target.closest('.operation-menu-btn')) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('下拉選單按鈕被點擊');
                    
                    const btn = e.target.closest('.operation-menu-btn');
                    const menu = btn.nextElementSibling;
                    
                    // 關閉所有其他下拉選單
                    document.querySelectorAll('.operation-menu').forEach(m => {
                        if (m !== menu) {
                            m.classList.add('hidden');
                        }
                    });
                    
                    // 切換當前下拉選單
                    menu.classList.toggle('hidden');
                    console.log('切換下拉選單可見性:', !menu.classList.contains('hidden'));
                }
                // 如果點擊的不是選單按鈕或選單內容，關閉所有選單
                else if (!e.target.closest('.operation-menu')) {
                    document.querySelectorAll('.operation-menu').forEach(menu => {
                        menu.classList.add('hidden');
                    });
                }
            });
            
            // 根據賽事狀態動態設置操作選項
            console.log('初始化操作選項');
            
            // 手動修改初始HTML結構中的結算賽事和取消賽事按鈕為a標籤
            console.log('將靜態按鈕轉換為連結...');
            document.querySelectorAll('.js-settle-match, .js-cancel-match').forEach(btn => {
                if (btn.tagName.toLowerCase() === 'button') {
                    console.log('找到靜態按鈕:', btn.textContent.trim());
                    
                    // 創建替代的a標籤
                    const link = document.createElement('a');
                    
                    // 複製所有屬性
                    for (const attr of btn.attributes) {
                        link.setAttribute(attr.name, attr.value);
                    }
                    
                    // 設置href屬性
                    if (btn.classList.contains('js-settle-match')) {
                        const matchId = btn.getAttribute('data-match-id');
                        const homeTeam = btn.getAttribute('data-home-team') || '';
                        const awayTeam = btn.getAttribute('data-away-team') || '';
                        link.href = `settle.html?id=${matchId}&home=${encodeURIComponent(homeTeam)}&away=${encodeURIComponent(awayTeam)}`;
                    } else if (btn.classList.contains('js-cancel-match')) {
                        const matchId = btn.getAttribute('data-match-id');
                        link.href = `cancel.html?id=${matchId}`;
                    }
                    
                    // 複製內容
                    link.innerHTML = btn.innerHTML;
                    
                    // 替換按鈕
                    btn.parentNode.replaceChild(link, btn);
                    console.log('已替換為連結');
                }
            });
            
            // 然後再運行setupActionMenus函數
            setupActionMenus();
            
            function setupActionMenus() {
                try {
                    document.querySelectorAll('tbody tr').forEach((row, index) => {
                        // 只處理每兩行中的第一行（因為每個賽事佔兩行）
                        if (index % 2 === 0) {
                            const statusCell = row.querySelector('td:nth-child(13) span');
                            const dropdownMenu = row.querySelector('.operation-menu');
                            
                            if (statusCell && dropdownMenu) {
                                const status = statusCell.textContent.trim();
                                const matchId = row.querySelector('td:first-child div')?.textContent;
                                
                                // 清空菜單
                                dropdownMenu.innerHTML = '<div class="py-1" role="none"></div>';
                                const menuContent = dropdownMenu.querySelector('.py-1');
                                
                                // 如果是已結算或取消狀態，只顯示查看詳情選項
                                if (status === '已結算' || status === '已取消' || status === '取消') {
                                    console.log(`行 ${index}: 添加查看詳情選項`);
                                    const detailOption = document.createElement('a');
                                    detailOption.href = `detail.html?id=${matchId}`;
                                    detailOption.className = 'group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 w-full text-left';
                                    detailOption.innerHTML = '<i class="fas fa-eye mr-3 text-gray-600"></i>查看詳情';
                                    menuContent.appendChild(detailOption);
                                } else {
                                    // 編輯選項
                                    console.log(`行 ${index}: 添加編輯選項`);
                                    const editOption = document.createElement('a');
                                    editOption.href = `edit.html?id=${matchId}`;
                                    editOption.className = 'group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 w-full text-left';
                                    editOption.innerHTML = '<i class="fas fa-edit mr-3 text-indigo-600"></i>編輯賽事';
                                    menuContent.appendChild(editOption);
                                    
                                    // 根據狀態添加不同選項
                                    if (status === '開放投注') {
                                        console.log(`行 ${index}: 添加暫停投注選項`);
                                        // 暫停投注選項
                                        const pauseOption = document.createElement('button');
                                        pauseOption.className = 'js-pause-bet group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 w-full text-left';
                                        pauseOption.setAttribute('data-match-id', matchId);
                                        pauseOption.innerHTML = '<i class="fas fa-pause mr-3 text-yellow-600"></i>暫停投注';
                                        menuContent.appendChild(pauseOption);
                                    } else if (status === '暫停投注') {
                                        console.log(`行 ${index}: 添加開放投注選項`);
                                        // 開放投注選項
                                        const openOption = document.createElement('button');
                                        openOption.className = 'js-open-bet group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 w-full text-left';
                                        openOption.setAttribute('data-match-id', matchId);
                                        openOption.innerHTML = '<i class="fas fa-play mr-3 text-green-600"></i>開放投注';
                                        menuContent.appendChild(openOption);
                                    }
                                    
                                    // 結算賽事選項（對於尚未結算的賽事）
                                    if (status !== '已結算' && status !== '取消' && status !== '已取消') {
                                        console.log(`行 ${index}: 添加結算賽事選項`);
                                        const settleOption = document.createElement('a');
                                        settleOption.className = 'js-settle-match group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 w-full text-left';
                                        settleOption.setAttribute('data-match-id', matchId);
                                        settleOption.setAttribute('data-home-team', row.querySelector('td:nth-child(3) div').textContent);
                                        settleOption.setAttribute('data-away-team', row.querySelector('td:nth-child(4) div').textContent);
                                        settleOption.href = `settle.html?id=${matchId}&home=${encodeURIComponent(row.querySelector('td:nth-child(3) div').textContent)}&away=${encodeURIComponent(row.querySelector('td:nth-child(4) div').textContent)}`;
                                        settleOption.innerHTML = '<i class="fas fa-check-double mr-3 text-blue-600"></i>結算賽事';
                                        menuContent.appendChild(settleOption);
                                        
                                        // 取消賽事選項（除了已結算和取消狀態外都可以取消）
                                        console.log(`行 ${index}: 添加取消賽事選項`);
                                        const cancelOption = document.createElement('a');
                                        cancelOption.className = 'js-cancel-match group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 w-full text-left';
                                        cancelOption.setAttribute('data-match-id', matchId);
                                        cancelOption.href = `cancel.html?id=${matchId}`;
                                        cancelOption.innerHTML = '<i class="fas fa-times-circle mr-3 text-red-600"></i>取消賽事';
                                        menuContent.appendChild(cancelOption);
                                    }
                                }
                            }
                        }
                    });
                } catch (err) {
                    console.error('設置操作選項時出錯:', err);
                }
            }
            
            // 暫停投注確認按鈕事件
            const confirmPauseBtn = document.getElementById('confirm-pause-btn');
            if (confirmPauseBtn) {
                confirmPauseBtn.addEventListener('click', function() {
                    try {
                        console.log('確認暫停按鈕被點擊');
                        const rowIndex = this.getAttribute('data-row');
                        console.log('行索引:', rowIndex);
                        
                        if (rowIndex) {
                            const row = document.querySelector(`tbody tr:nth-child(${2 * Math.ceil(rowIndex / 2) - 1})`);
                            if (row) {
                                const statusCell = row.querySelector('td:nth-child(13) span');
                                if (statusCell) {
                                    // 變更狀態
                                    statusCell.textContent = '暫停投注';
                                    statusCell.className = 'px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800';
                                    
                                    // 關閉彈窗
                                    document.getElementById('pause-confirm-modal').classList.add('hidden');
                                    
                                    // 重新設置選項
                                    setupActionMenus();
                                    
                                    // 提示用戶操作成功
                                    const matchId = row.querySelector('td:first-child div').textContent;
                                    alert('已暫停投注：' + matchId);
                                } else {
                                    console.error('找不到狀態單元格');
                                }
                            } else {
                                console.error('找不到對應的行');
                            }
                        } else {
                            console.error('沒有行索引');
                        }
                    } catch (err) {
                        console.error('確認暫停按鈕事件出錯:', err);
                    }
                });
            } else {
                console.error('找不到確認暫停按鈕元素');
            }
            
            // 取消暫停投注按鈕事件
            const cancelPauseBtn = document.getElementById('cancel-pause-btn');
            if (cancelPauseBtn) {
                cancelPauseBtn.addEventListener('click', function() {
                    document.getElementById('pause-confirm-modal').classList.add('hidden');
                });
            } else {
                console.error('找不到取消暫停按鈕元素');
            }
            
            // 取消賽事確認按鈕事件
            const confirmCancelBtn = document.getElementById('confirm-cancel-btn');
            if (confirmCancelBtn) {
                confirmCancelBtn.addEventListener('click', function() {
                    try {
                        console.log('確認取消賽事按鈕被點擊');
                        const rowIndex = this.getAttribute('data-row');
                        const cancelReason = document.getElementById('cancel-reason').value;
                        
                        if (!cancelReason.trim()) {
                            alert('請輸入取消賽事原因');
                            return;
                        }
                        
                        if (rowIndex) {
                            const row = document.querySelector(`tbody tr:nth-child(${2 * Math.ceil(rowIndex / 2) - 1})`);
                            if (row) {
                                const statusCell = row.querySelector('td:nth-child(13) span');
                                const matchId = row.querySelector('td:first-child div').textContent;
                                
                                // 變更狀態
                                statusCell.textContent = '已取消';
                                statusCell.className = 'px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800';
                                
                                // 關閉彈窗
                                document.getElementById('cancel-confirm-modal').classList.add('hidden');
                                
                                // 重新設置選項
                                setupActionMenus();
                                
                                // 提示用戶操作成功
                                alert(`已取消賽事：${matchId}\n取消原因：${cancelReason}`);
                            }
                        }
                    } catch (err) {
                        console.error('確認取消賽事按鈕事件出錯:', err);
                    }
                });
            } else {
                console.error('找不到確認取消賽事按鈕元素');
            }
            
            // 因為移除了取消賽事彈窗，相關功能已經移至獨立頁面
            
            // 因為移除了結算賽事和取消賽事彈窗，相關功能已經移至獨立頁面
            
            // 點擊模態視窗背景關閉模態視窗
            document.querySelectorAll('#pause-confirm-modal').forEach(modal => {
                modal.addEventListener('click', function(event) {
                    if (event.target === this) {
                        this.classList.add('hidden');
                    }
                });
            });
            
            console.log('頁面初始化完成');
            
            // 使用事件委託處理所有操作按鈕點擊
            document.addEventListener('click', function(e) {
                // 暫停投注按鈕
                if (e.target.classList.contains('js-pause-bet') || e.target.closest('.js-pause-bet')) {
                    e.preventDefault();
                    console.log('點擊暫停投注按鈕');
                    const link = e.target.classList.contains('js-pause-bet') ? e.target : e.target.closest('.js-pause-bet');
                    const matchId = link.getAttribute('data-match-id');
                    
                    // 設置彈窗內容
                    document.getElementById('pause-match-id').textContent = matchId;
                    // 顯示確認視窗
                    document.getElementById('pause-confirm-modal').classList.remove('hidden');
                    
                    // 查找對應的行
                    const row = findRowByMatchId(matchId);
                    if (row) {
                        // 儲存當前行以供確認按鈕使用
                        document.getElementById('confirm-pause-btn').setAttribute('data-row', row.rowIndex);
                    }
                }
                
                // 開放投注按鈕
                else if (e.target.classList.contains('js-open-bet') || e.target.closest('.js-open-bet')) {
                    e.preventDefault();
                    console.log('點擊開放投注按鈕');
                    const link = e.target.classList.contains('js-open-bet') ? e.target : e.target.closest('.js-open-bet');
                    const matchId = link.getAttribute('data-match-id');
                    
                    // 查找對應的行
                    const row = findRowByMatchId(matchId);
                    if (row) {
                        const statusCell = row.querySelector('td:nth-child(13) span');
                        
                        // 直接變更狀態，無需確認
                        alert('已開放投注：' + matchId);
                        statusCell.textContent = '開放投注';
                        statusCell.className = 'px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800';
                        setupActionMenus(); // 重新設置選項
                    }
                }
                
                // 結算賽事按鈕 - 我們不需要阻止默認行為，因為我們希望它導航到settle.html頁面
                else if (e.target.classList.contains('js-settle-match') || e.target.closest('.js-settle-match')) {
                    console.log('點擊結算賽事按鈕');
                    // 檢查元素是否為按鈕
                    const element = e.target.classList.contains('js-settle-match') ? e.target : e.target.closest('.js-settle-match');
                    
                    // 如果是按鈕元素且沒有href屬性，則手動執行跳轉
                    if (element.tagName.toLowerCase() === 'button') {
                        e.preventDefault(); // 阻止可能的默認行為
                        const matchId = element.getAttribute('data-match-id');
                        const homeTeam = element.getAttribute('data-home-team');
                        const awayTeam = element.getAttribute('data-away-team');
                        
                        // 構建URL並跳轉
                        let url = `settle.html?id=${matchId}`;
                        if (homeTeam) url += `&home=${encodeURIComponent(homeTeam)}`;
                        if (awayTeam) url += `&away=${encodeURIComponent(awayTeam)}`;
                        
                        console.log('跳轉到:', url);
                        window.location.href = url;
                    }
                    // 如果是a標籤，瀏覽器會自動處理跳轉
                }
                
                // 取消賽事按鈕 - 我們不需要阻止默認行為，因為我們希望它導航到cancel.html頁面
                else if (e.target.classList.contains('js-cancel-match') || e.target.closest('.js-cancel-match')) {
                    console.log('點擊取消賽事按鈕');
                    // 檢查元素是否為按鈕
                    const element = e.target.classList.contains('js-cancel-match') ? e.target : e.target.closest('.js-cancel-match');
                    
                    // 如果是按鈕元素且沒有href屬性，則手動執行跳轉
                    if (element.tagName.toLowerCase() === 'button') {
                        e.preventDefault(); // 阻止可能的默認行為
                        const matchId = element.getAttribute('data-match-id');
                        
                        // 構建URL並跳轉
                        const url = `cancel.html?id=${matchId}`;
                        console.log('跳轉到:', url);
                        window.location.href = url;
                    }
                    // 如果是a標籤，瀏覽器會自動處理跳轉
                }
                
                // 查看詳情按鈕
                else if (e.target.classList.contains('js-view-detail') || e.target.closest('.js-view-detail')) {
                    e.preventDefault();
                    console.log('點擊查看詳情按鈕');
                    const link = e.target.classList.contains('js-view-detail') ? e.target : e.target.closest('.js-view-detail');
                    const matchId = link.getAttribute('data-match-id');
                    
                    alert('查看賽事詳情：' + matchId);
                }
            });
            
            // 根據賽事ID查找對應的表格行
            function findRowByMatchId(matchId) {
                let foundRow = null;
                document.querySelectorAll('tbody tr').forEach((row, index) => {
                    // 只處理每兩行中的第一行（因為每個賽事佔兩行）
                    if (index % 2 === 0) {
                        const rowMatchId = row.querySelector('td:first-child div')?.textContent;
                        if (rowMatchId === matchId) {
                            foundRow = row;
                        }
                    }
                });
                return foundRow;
            }

                    // 已在上方移除這個重複的監聽器
        } catch (err) {
            console.error('頁面初始化時出錯:', err);
        }
    });
    </script>

    <!-- 暫停投注確認視窗 -->
    <div id="pause-confirm-modal" class="fixed inset-0 z-50 overflow-y-auto hidden">
        <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 transition-opacity" aria-hidden="true">
                <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
            </div>
            
            <!-- 模態視窗內容 -->
            <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
                <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="sm:flex sm:items-start">
                        <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 sm:mx-0 sm:h-10 sm:w-10">
                            <i class="fas fa-exclamation-triangle text-yellow-600"></i>
                        </div>
                        <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                            <h3 class="text-lg leading-6 font-medium text-gray-900" id="pause-modal-title">
                                暫停投注確認
                            </h3>
                            <div class="mt-2">
                                <p class="text-sm text-gray-500" id="pause-modal-message">
                                    確定要暫停賽事投注: <span id="pause-match-id" class="font-medium"></span>?
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" id="confirm-pause-btn" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-yellow-600 text-base font-medium text-white hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 sm:ml-3 sm:w-auto sm:text-sm">
                        確定暫停
                    </button>
                    <button type="button" id="cancel-pause-btn" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
                        取消
                    </button>
                </div>
            </div>
        </div>
    </div>


</body>
</html> 